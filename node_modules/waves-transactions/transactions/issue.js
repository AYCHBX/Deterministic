"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const transactions_1 = require("../transactions");
const waves_crypto_1 = require("waves-crypto");
const generic_1 = require("../generic");
const marshall_1 = require("@waves/marshall");
function issue(paramsOrTx, seed) {
    const type = transactions_1.TRANSACTION_TYPE.ISSUE;
    const version = paramsOrTx.version || 2;
    const seedsAndIndexes = generic_1.convertToPairs(seed);
    const senderPublicKey = generic_1.getSenderPublicKey(seedsAndIndexes, paramsOrTx);
    const tx = {
        type,
        version,
        senderPublicKey,
        name: paramsOrTx.name,
        description: paramsOrTx.description,
        quantity: paramsOrTx.quantity,
        script: paramsOrTx.script == null ? undefined : generic_1.base64Prefix(paramsOrTx.script),
        decimals: paramsOrTx.decimals || 8,
        reissuable: paramsOrTx.reissuable || false,
        fee: generic_1.fee(paramsOrTx, 100000000),
        timestamp: Date.now(),
        chainId: generic_1.networkByte(paramsOrTx.chainId, 87),
        proofs: paramsOrTx.proofs || [],
        id: '',
    };
    const bytes = marshall_1.binary.serializeTx(tx);
    seedsAndIndexes.forEach(([s, i]) => generic_1.addProof(tx, waves_crypto_1.signBytes(bytes, s), i));
    tx.id = waves_crypto_1.hashBytes(bytes);
    return tx;
}
exports.issue = issue;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXNzdWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdHJhbnNhY3Rpb25zL2lzc3VlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsa0RBQXVHO0FBQ3ZHLCtDQUFtRDtBQUNuRCx3Q0FBeUc7QUFFekcsOENBQXdDO0FBb0R4QyxTQUFnQixLQUFLLENBQUMsVUFBZSxFQUFFLElBQWlCO0lBQ3RELE1BQU0sSUFBSSxHQUFHLCtCQUFnQixDQUFDLEtBQUssQ0FBQztJQUNwQyxNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQztJQUN4QyxNQUFNLGVBQWUsR0FBRyx3QkFBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzdDLE1BQU0sZUFBZSxHQUFHLDRCQUFrQixDQUFDLGVBQWUsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUV4RSxNQUFNLEVBQUUsR0FBK0I7UUFDckMsSUFBSTtRQUNKLE9BQU87UUFDUCxlQUFlO1FBQ2YsSUFBSSxFQUFFLFVBQVUsQ0FBQyxJQUFJO1FBQ3JCLFdBQVcsRUFBRSxVQUFVLENBQUMsV0FBVztRQUNuQyxRQUFRLEVBQUUsVUFBVSxDQUFDLFFBQVE7UUFDN0IsTUFBTSxFQUFFLFVBQVUsQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLHNCQUFZLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBRTtRQUNoRixRQUFRLEVBQUUsVUFBVSxDQUFDLFFBQVEsSUFBSSxDQUFDO1FBQ2xDLFVBQVUsRUFBRSxVQUFVLENBQUMsVUFBVSxJQUFJLEtBQUs7UUFDMUMsR0FBRyxFQUFFLGFBQUcsQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDO1FBQy9CLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO1FBQ3JCLE9BQU8sRUFBRSxxQkFBVyxDQUFDLFVBQVUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO1FBQzVDLE1BQU0sRUFBRSxVQUFVLENBQUMsTUFBTSxJQUFJLEVBQUU7UUFDL0IsRUFBRSxFQUFFLEVBQUU7S0FDUCxDQUFDO0lBRUYsTUFBTSxLQUFLLEdBQUcsaUJBQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7SUFFckMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBUSxDQUFDLEVBQUUsRUFBRSx3QkFBUyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzFFLEVBQUUsQ0FBQyxFQUFFLEdBQUcsd0JBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUV6QixPQUFPLEVBQUUsQ0FBQTtBQUNYLENBQUM7QUE3QkQsc0JBNkJDIn0=