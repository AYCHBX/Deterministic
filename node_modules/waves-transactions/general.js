"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const axios_1 = __importDefault(require("axios"));
const transactions_1 = require("./transactions");
const issue_1 = require("./transactions/issue");
const transfer_1 = require("./transactions/transfer");
const reissue_1 = require("./transactions/reissue");
const burn_1 = require("./transactions/burn");
const lease_1 = require("./transactions/lease");
const cancel_lease_1 = require("./transactions/cancel-lease");
const data_1 = require("./transactions/data");
const mass_transfer_1 = require("./transactions/mass-transfer");
const alias_1 = require("./transactions/alias");
const set_script_1 = require("./transactions/set-script");
const generic_1 = require("./generic");
const set_asset_script_1 = require("./transactions/set-asset-script");
const marshall_1 = require("@waves/marshall");
const txTypeMap = {
    [transactions_1.TRANSACTION_TYPE.ISSUE]: { sign: (x, seed) => issue_1.issue(x, seed) },
    [transactions_1.TRANSACTION_TYPE.TRANSFER]: { sign: (x, seed) => transfer_1.transfer(x, seed) },
    [transactions_1.TRANSACTION_TYPE.REISSUE]: { sign: (x, seed) => reissue_1.reissue(x, seed) },
    [transactions_1.TRANSACTION_TYPE.BURN]: { sign: (x, seed) => burn_1.burn(x, seed) },
    [transactions_1.TRANSACTION_TYPE.LEASE]: { sign: (x, seed) => lease_1.lease(x, seed) },
    [transactions_1.TRANSACTION_TYPE.CANCEL_LEASE]: { sign: (x, seed) => cancel_lease_1.cancelLease(x, seed) },
    [transactions_1.TRANSACTION_TYPE.ALIAS]: { sign: (x, seed) => alias_1.alias(x, seed) },
    [transactions_1.TRANSACTION_TYPE.MASS_TRANSFER]: { sign: (x, seed) => mass_transfer_1.massTransfer(x, seed) },
    [transactions_1.TRANSACTION_TYPE.DATA]: { sign: (x, seed) => data_1.data(x, seed) },
    [transactions_1.TRANSACTION_TYPE.SET_SCRIPT]: { sign: (x, seed) => set_script_1.setScript(x, seed) },
    [transactions_1.TRANSACTION_TYPE.SET_ASSET_SCRIPT]: { sign: (x, seed) => set_asset_script_1.setAssetScript(x, seed) }
};
exports.signTx = (tx, seed) => {
    if (!txTypeMap[tx.type])
        throw new Error(`Unknown tx type: ${tx.type}`);
    return txTypeMap[tx.type].sign(tx, seed);
};
exports.serialize = (obj) => {
    if (generic_1.isOrder(obj))
        return marshall_1.binary.serializeOrder(obj);
    return marshall_1.binary.serializeTx(obj);
};
exports.broadcast = (tx, apiBase) => axios_1.default.post('transactions/broadcast', marshall_1.json.stringifyTx(tx), {
    baseURL: apiBase,
    headers: { 'content-type': 'application/json' }
})
    .then(x => x.data)
    .catch(e => Promise.reject(e.response && e.response.status === 400 ? new Error(e.response.data.message) : e));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9nZW5lcmFsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsa0RBQXlCO0FBQ3pCLGlEQVF1QjtBQUV2QixnREFBNEM7QUFDNUMsc0RBQWtEO0FBQ2xELG9EQUFnRDtBQUNoRCw4Q0FBMEM7QUFDMUMsZ0RBQTRDO0FBQzVDLDhEQUF5RDtBQUN6RCw4Q0FBMEM7QUFDMUMsZ0VBQTJEO0FBQzNELGdEQUE0QztBQUM1QywwREFBcUQ7QUFDckQsdUNBQW9DO0FBQ3BDLHNFQUFpRTtBQUNqRSw4Q0FBOEM7QUFNOUMsTUFBTSxTQUFTLEdBQThGO0lBQzNHLENBQUMsK0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxhQUFLLENBQUMsQ0FBc0IsRUFBRSxJQUFJLENBQUMsRUFBQztJQUNuRixDQUFDLCtCQUFnQixDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsbUJBQVEsQ0FBQyxDQUF5QixFQUFFLElBQUksQ0FBQyxFQUFFO0lBQzdGLENBQUMsK0JBQWdCLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxpQkFBTyxDQUFDLENBQXdCLEVBQUUsSUFBSSxDQUFDLEVBQUU7SUFDMUYsQ0FBQywrQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLFdBQUksQ0FBQyxDQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFO0lBQ2pGLENBQUMsK0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFF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